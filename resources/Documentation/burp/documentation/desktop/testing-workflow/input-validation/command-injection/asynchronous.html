<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/assets/ps/styles/psselfservice.css">
<cms page-layout="FREESTYLE" ignore-validation="OTHER_PAGE_KEYWORD_TOO_FREQUENT"></cms>
</head>
<body class="section theme-white wrapper-themed">
<section class="container ps-breadcrumbs">
    <ol class="breadcrumb-list">
        <li>
            <a href="https://portswigger.net/support">Support Center</a>
        </li>
        <li>
            <a href="/burp/documentation/index.html">Documentation</a>
        </li>
        <li>
            <a href="/burp/documentation/desktop/index.html">Desktop editions</a>
        </li>
        <li>
            <a href="/burp/documentation/desktop/testing-workflow/index.html">Testing workflow</a>
        </li>
        <li>
            <a href="/burp/documentation/desktop/testing-workflow/input-validation/index.html">Testing input validation</a>
        </li>
        <li>
            <a href="/burp/documentation/desktop/testing-workflow/input-validation/command-injection/index.html">OS command injection</a>
        </li>
        <li>
            <a href="/burp/documentation/desktop/testing-workflow/input-validation/command-injection/asynchronous.html">Testing for asynchronous OS command injection vulnerabilities</a>
        </li>
    </ol>
</section>
<section class="container labels-editions-wrapper">
    <label class="label-edition is-professional">Professional</label>
</section>
<h1>Testing for asynchronous OS command injection vulnerabilities with Burp Suite</h1>
<div class="container">
    <div class="youtube-wrapper">
        <iframe src="https://www.youtube.com/embed/tsX1iI0YiSk?origin=https://portswigger.net&rel=0" allowfullscreen></iframe>
    </div>
</div>
<p>
    Asynchronous OS command injection vulnerabilities occur when an application is vulnerable to command injection, but the command is executed asynchronously. This means that it has no noticeable impact on the application's response.
</p>
<p>
    Burp Collaborator can help you to test for asynchronous command injection vulnerabilities. You can use Burp to inject a command that triggers an out-of-band network interaction with the Burp Collaborator server. Burp monitors the Collaborator server to identify whether an out-of-band interaction occurs, and therefore whether the command was executed.
</p>
<h2 id="steps" cms-ignore-validation="DUPLICATE_HEADINGS">Steps</h2>
<p>
    You can follow this process using the lab <a href="/web-security/os-command-injection/lab-blind-out-of-band.html">Blind OS command injection with out-of-band interaction</a>.
</p>
<ol>
    <li>
        In <strong>Proxy &gt; HTTP history</strong>, identify a request that you want to investigate.
    </li>
    <li>
        Right-click the request and select <strong>Send to Repeater</strong>.
    </li>
    <li>
        Change a parameter's value to a proof-of-concept payload. The payload should use the <code>nslookup</code> command to cause a DNS lookup for a Collaborator subdomain. To insert a Collaborator subdomain into the payload, right-click and select <strong>Insert Collaborator payload</strong>.
    </li>
    <li>
        Click <strong>Send</strong>.
    </li>
    <li>
        Go to the <strong>Collaborator</strong> tab and click <strong>Poll now</strong>. Any interactions with the Collaborator server are listed in the table. If an interaction occurs, this indicates that the command was successfully injected.
    </li>
    <li>
        Repeat Steps 3 and 4 to test additional parameters that look like they may be used in shell commands.
    </li>
</ol>
<div class="highlightedarea">
    <h4>Note</h4>
    <p>
        The command may be executed after a delay. The <strong>Collaborator</strong> tab flashes when an interaction occurs. Make sure that you continue to check the <strong>Collaborator</strong> tab to identify any delayed interactions.
    </p>
</div>
<div class="highlightedarea">
    <h4>Related pages</h4>
    <ul>
        <li>
            Academy: <a href="/web-security/os-command-injection/index.html">OS command injection</a>
        </li>
        <li>
            <a href="/burp/documentation/desktop/tools/collaborator/index.html">Burp Collaborator</a>
        </li>
        <li>
            <a href="/burp/documentation/desktop/tools/repeater/index.html">Burp Repeater</a>
        </li>
    </ul>
</div>
</body>
</html>