<!doctype html>
<html>
<body>
<h1>Issue name</h1>
GraphQL content type not validated
<h1>Typical severity</h1>
Low
<h1>Issue description</h1>

<p>Cross-site request forgery (CSRF) vulnerabilities enable an attacker to induce users to perform actions that they do not intend to perform. This is done by creating a malicious website that forges a cross-domain request to the vulnerable application.</p>
<p>Cross-site request forgery (CSRF) vulnerabilities in a GraphQL endpoint can arise when the content type is not validated. POST requests using a content-type of application/json are secure against forgery as long as the content type is validated, as an attacker wouldn't be able to make the victim's browser send this request.</p>
<p>However, alternative methods such as GET, or any request that has a content-type of x-www-form-urlencoded, can be sent by a browser and so may leave users vulnerable to attack. Where this is the case, attackers may be able to craft exploits that use a valid CSRF token from a previous request to send malicious requests to the API.</p>

<h1>Issue remediation</h1>

<p>Ensure that your GraphQL endpoint validates the content type. If the content type cannot be validated, ensure a valid CSRF token is required.</p>

<h1>References</h1>
<ul>
    <li>
        <a href="https://portswigger.net/web-security/graphql">Web Security Academy: GraphQL API vulnerabilities</a>
    </li>
    <li>
        <a href="https://portswigger.net/web-security/csrf">Web Security Academy: Cross-site request forgery</a>
    </li>
</ul>

<h1>Vulnerability classifications</h1>
<ul>
    <li>
        <a href="https://cwe.mitre.org/data/definitions/352.html">CWE-352: Cross-Site Request Forgery</a>
    </li>
    <li>
        <a href="https://capec.mitre.org/data/definitions/62.html">CAPEC-62: Cross-Site Request Forgery</a>
    </li>
</ul>
<h1>Web intro</h1>

</body>
</html>
